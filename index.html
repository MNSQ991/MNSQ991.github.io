<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>ğŸ® å¤šæ¸¸æˆå¤§å…</title>
  <meta name="description" content="è´ªåƒè›‡ | äº”å­æ£‹ | çŒœæ•°å­—">

  <!-- PWA è®¾ç½® -->
  <meta name="theme-color" content="#111">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="mobile-web-app-capable" content="yes">

  <!-- Cloudflare Web Analytics -->
  <script defer src='https://static.cloudflareinsights.com/beacon.min.js'
          data-cf-beacon='{"token": "ce8176d5e3c44c9a8b20d9f0e5d6a7b8"}'></script>

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #f0f0f0;
      text-align: center;
      padding: 10px;
      color: #333;
    }

    h1 {
      color: #0074D9;
      margin: 15px 0;
    }

    /* ä¸»èœå•ç½‘æ ¼ */
    .menu-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      max-width: 800px;
      margin: 20px auto;
    }

    .menu-btn {
      height: 150px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      font-weight: bold;
      color: white;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      transition: transform 0.2s;
    }
    .menu-btn:hover {
      transform: scale(1.05);
    }
    .menu-btn:active {
      transform: scale(0.98);
    }

    #snake-btn { background: linear-gradient(135deg, #0074D9, #0056a3); }
    #gobang-btn { background: linear-gradient(135deg, #393, #262); }
    #guess-btn { background: linear-gradient(135deg, #D9534F, #a0302a); }

    /* æ¸¸æˆå®¹å™¨ */
    .game-container {
      display: none;
      max-width: 800px;
      margin: 20px auto;
      padding: 20px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      text-align: center;
    }

    .game-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    .game-header h2 {
      color: #0074D9;
    }
    .back-btn {
      background: #ccc;
      color: #333;
      border: none;
      padding: 8px 16px;
      border-radius: 5px;
      cursor: pointer;
    }

    /* è´ªåƒè›‡æ ·å¼ */
    #snake-game {
      width: 400px;
      height: 400px;
      margin: 0 auto;
      border: 8px solid #333;
      background: #111;
      position: relative;
    }
    .snake-part { position: absolute; width: 20px; height: 20px; background: #0f0; border-radius: 4px; }
    .snake-part:first-child { background: #0f8; box-shadow: 0 0 6px #0f8; }
    .food { position: absolute; width: 20px; height: 20px; background: red; border-radius: 50%; box-shadow: 0 0 8px yellow; }

    /* äº”å­æ£‹æ ·å¼ */
    #gobang-board {
      width: 400px;
      height: 400px;
      margin: 20px auto;
      background: #e8c497;
      border: 6px solid #8b4513;
      position: relative;
    }
    .gobang-line {
      position: absolute;
      background: #333;
    }
    .gobang-row { height: 1px; width: 380px; top: calc((var(--y) * 40px) + 10px); left: 10px; }
    .gobang-col { width: 1px; height: 380px; left: calc((var(--x) * 40px) + 10px); top: 10px; }
    .stone {
      position: absolute;
      width: 34px; height: 34px;
      border-radius: 50%;
      transform: translateY(-50%);
      box-shadow: 2px 2px 5px rgba(0,0,0,0.3);
    }
    .black { background: #111; top: calc((var(--y) * 40px) + 10px + 17px); left: calc((var(--x) * 40px) + 10px + 17px); }
    .white { background: #fff; top: calc((var(--y) * 40px) + 10px + 17px); left: calc((var(--x) * 40px) + 10px + 17px); }

    /* çŒœæ•°å­—æ ·å¼ */
    #guess-input {
      padding: 10px;
      font-size: 18px;
      margin: 10px;
      width: 150px;
    }
    #guess-log {
      text-align: left;
      margin: 15px auto;
      padding: 10px;
      background: #f5f5f5;
      border-radius: 5px;
      max-height: 200px;
      overflow-y: auto;
      font-size: 14px;
    }

    .footer {
      margin-top: 40px;
      color: #666;
      font-size: 0.9em;
    }
    .footer a {
      color: #0074D9;
      text-decoration: none;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <h1>ğŸ® å¤šæ¸¸æˆå¤§å…</h1>

  <!-- ä¸»èœå• -->
  <div class="menu-grid">
    <button class="menu-btn" onclick="showGame('snake')">ğŸ è´ªåƒè›‡</button>
    <button class="menu-btn" onclick="showGame('gobang')">âš« äº”å­æ£‹</button>
    <button class="menu-btn" style="grid-column: span 2;" onclick="showGame('guess')"> ğŸ”¢ çŒœæ•°å­—</button>
  </div>

  <!-- è´ªåƒè›‡æ¸¸æˆ -->
  <div id="snake-screen" class="game-container">
    <div class="game-header">
      <h2>ğŸ è´ªåƒè›‡</h2>
      <button class="back-btn" onclick="backToMenu()">è¿”å›</button>
    </div>
    <div id="snake-game"></div>
    <div>å¾—åˆ†ï¼š<span id="snake-score">0</span></div>
    <div style="margin: 10px;">
      <button onclick="setSnakeDir('up')">â¬†ï¸</button><br/>
      <button onclick="setSnakeDir('left')">â¬…ï¸</button>
      <button onclick="setSnakeDir('right')">â¡ï¸</button><br/>
      <button onclick="setSnakeDir('down')">â¬‡ï¸</button>
    </div>
  </div>

  <!-- äº”å­æ£‹æ¸¸æˆ -->
  <div id="gobang-screen" class="game-container">
    <div class="game-header">
      <h2>âš« äº”å­æ£‹</h2>
      <button class="back-btn" onclick="backToMenu()">è¿”å›</button>
    </div>
    <div>å½“å‰ç©å®¶ï¼š<span id="gobang-player" style="color: #111;">é»‘å­</span></div>
    <div id="gobang-board"></div>
    <button onclick="resetGobang()">ğŸ”„ é‡æ–°å¼€å§‹</button>
  </div>

  <!-- çŒœæ•°å­—æ¸¸æˆ -->
  <div id="guess-screen" class="game-container">
    <div class="game-header">
      <h2>ğŸ”¢ çŒœæ•°å­—</h2>
      <button class="back-btn" onclick="backToMenu()">è¿”å›</button>
    </div>
    <p>æˆ‘æƒ³åˆ°ä¸€ä¸ª 1-100 çš„æ•°å­—ï¼Œä½ æ¥çŒœï¼</p>
    <input type="number" id="guess-input" min="1" max="100" />
    <button onclick="checkGuess()">æäº¤</button>
    <div id="guess-log"></div>
  </div>

  <div class="footer">
    <a href="blog.html">â¬…ï¸ å›åšå®¢ä¸»é¡µ</a> | å¯æ·»åŠ åˆ°ä¸»å±å¹•ç¦»çº¿æ¸¸ç©ï¼
  </div>

  <script>
    // ============ å…¨å±€å‡½æ•° ============
    function showGame(gameId) {
      document.querySelectorAll('.game-container').forEach(el => el.style.display = 'none');
      document.getElementById(gameId + '-screen').style.display = 'block';
      if (gameId === 'snake') initSnake();
      if (gameId === 'gobang') initGobang();
      if (gameId === 'guess') initGuess();
    }

    function backToMenu() {
      document.querySelectorAll('.game-container').forEach(el => el.style.display = 'none');
    }

    // ============ è´ªåƒè›‡ ============
    let snake = [], food = {}, direction = 'right', nextDir = 'right';
    let snakeScore = 0, snakeInterval;

    function initSnake() {
      const game = document.getElementById('snake-game');
      game.innerHTML = '';
      snake = [{x: 10, y: 10}];
      direction = 'right'; nextDir = 'right';
      snakeScore = 0;
      document.getElementById('snake-score').textContent = 0;
      createSnakeFood();
      drawSnake();
      clearInterval(snakeInterval);
      snakeInterval = setInterval(moveSnake, 150);
    }

    function createSnakeFood() {
      food = {
        x: Math.floor(Math.random() * 20),
        y: Math.floor(Math.random() * 20)
      };
    }

    function drawSnake() {
      document.querySelectorAll('.snake-part, .food').forEach(el => el.remove());
      snake.forEach((part, i) => {
        const el = document.createElement('div');
        el.className = 'snake-part';
        el.style.left = part.x * 20 + 'px';
        el.style.top = part.y * 20 + 'px';
        document.getElementById('snake-game').appendChild(el);
      });
      const f = document.createElement('div');
      f.className = 'food';
      f.style.left = food.x * 20 + 'px';
      f.style.top = food.y * 20 + 'px';
      document.getElementById('snake-game').appendChild(f);
    }

    function moveSnake() {
      direction = nextDir;
      const head = {...snake[0]};
      switch (direction) {
        case 'up': head.y--; break;
        case 'down': head.y++; break;
        case 'left': head.x--; break;
        case 'right': head.x++; break;
      }
      if (head.x < 0 || head.x >= 20 || head.y < 0 || head.y >= 20) return gameOver();
      if (snake.some((p, i) => i > 0 && p.x === head.x && p.y === head.y)) return gameOver();
      snake.unshift(head);
      if (head.x === food.x && head.y === food.y) {
        snakeScore += 10;
        document.getElementById('snake-score').textContent = snakeScore;
        createSnakeFood();
      } else {
        snake.pop();
      }
      drawSnake();
    }

    function setSnakeDir(dir) {
      const opp = {up:'down', down:'up', left:'right', right:'left'};
      if (direction !== opp[dir]) nextDir = dir;
    }

    function gameOver() {
      clearInterval(snakeInterval);
      alert('æ¸¸æˆç»“æŸï¼å¾—åˆ†ï¼š' + snakeScore);
      backToMenu();
    }

    // ============ äº”å­æ£‹ ============
    let gobangBoard = Array(15).fill().map(() => Array(15).fill(0)); // 0:ç©º, 1:é»‘, 2:ç™½
    let currentPlayer = 1;

    function initGobang() {
      const board = document.getElementById('gobang-board');
      board.innerHTML = '';
      // ç”»çº¿
      for (let i = 0; i < 15; i++) {
        const row = document.createElement('div');
        row.className = 'gobang-line gobang-row';
        row.style.setProperty('--y', i);
        board.appendChild(row);
        const col = document.createElement('div');
        col.className = 'gobang-line gobang-col';
        col.style.setProperty('--x', i);
        board.appendChild(col);
      }
      // é‡ç½®
      gobangBoard = Array(15).fill().map(() => Array(15).fill(0));
      currentPlayer = 1;
      document.getElementById('gobang-player').textContent = 'é»‘å­';
      document.getElementById('gobang-player').style.color = '#111';
      board.onclick = placeStone;
    }

    function placeStone(e) {
      const rect = this.getBoundingClientRect();
      const x = Math.round((e.clientX - rect.left - 10) / 40);
      const y = Math.round((e.clientY - rect.top - 10) / 40);
      if (x < 0 || x > 14 || y < 0 || y > 14 || gobangBoard[y][x] !== 0) return;

      gobangBoard[y][x] = currentPlayer;
      const stone = document.createElement('div');
      stone.className = 'stone ' + (currentPlayer === 1 ? 'black' : 'white');
      stone.style.setProperty('--x', x);
      stone.style.setProperty('--y', y);
      this.appendChild(stone);

      if (checkWin(x, y, currentPlayer)) {
        setTimeout(() => {
          alert(`${currentPlayer === 1 ? 'é»‘å­' : 'ç™½å­'} è·èƒœï¼`);
          resetGobang();
        }, 100);
        return;
      }

      currentPlayer = 3 - currentPlayer; // 1â†’2, 2â†’1
      document.getElementById('gobang-player').textContent = currentPlayer === 1 ? 'é»‘å­' : 'ç™½å­';
      document.getElementById('gobang-player').style.color = currentPlayer === 1 ? '#111' : '#fff';
    }

    function checkWin(x, y, player) {
      const dirs = [[1,0],[0,1],[1,1],[1,-1]];
      for (let [dx, dy] of dirs) {
        let count = 1;
        for (let i = 1; i < 5; i++) {
          if (gobangBoard[y + dy*i]?.[x + dx*i] === player) count++;
          else break;
        }
        for (let i = 1; i < 5; i++) {
          if (gobangBoard[y - dy*i]?.[x - dx*i] === player) count++;
          else break;
        }
        if (count >= 5) return true;
      }
      return false;
    }

    function resetGobang() {
      initGobang();
    }

    // ============ çŒœæ•°å­— ============
    let targetNumber, guessCount, guessLog;

    function initGuess() {
      targetNumber = Math.floor(Math.random() * 100) + 1;
      guessCount = 0;
      guessLog = [];
      document.getElementById('guess-log').innerHTML = '';
    }

    function checkGuess() {
      const input = document.getElementById('guess-input');
      const guess = parseInt(input.value);
      if (isNaN(guess) || guess < 1 || guess > 100) {
        alert('è¯·è¾“å…¥ 1-100 çš„æ•°å­—ï¼');
        return;
      }
      guessCount++;
      if (guess === targetNumber) {
        const msg = `ğŸ‰ æ­å–œï¼ä½ çŒœå¯¹äº†ï¼ç­”æ¡ˆæ˜¯ ${targetNumber}ï¼Œå…±ç”¨äº† ${guessCount} æ¬¡ã€‚`;
        addLog(msg, 'green');
        setTimeout(() => {
          alert(msg);
          backToMenu();
        }, 500);
      } else if (guess > targetNumber) {
        addLog(`${guess} â€” å¤ªå¤§äº†ï¼`, 'orange');
      } else {
        addLog(`${guess} â€” å¤ªå°äº†ï¼`, 'blue');
      }
      input.value = '';
    }

    function addLog(text, color) {
      const log = document.getElementById('guess-log');
      const p = document.createElement('p');
      p.textContent = text;
      p.style.color = color;
      log.appendChild(p);
      log.scrollTop = log.scrollHeight;
    }

    // ============ Service Worker ============
    if ('serviceWorker' in navigator) {
      const swScript = `
        self.addEventListener('install', e => {
          e.waitUntil(caches.open('games-v1').then(cache => cache.addAll(['/'])));
        });
        self.addEventListener('fetch', e => {
          e.respondWith(caches.match(e.request).then(r => r || fetch(e.request)));
        });
      `;
      const blob = new Blob([swScript], { type: 'application/javascript' });
      const swUrl = URL.createObjectURL(blob);
      window.addEventListener('load', () => {
        navigator.serviceWorker.register(swUrl);
      });
    }

    // åˆå§‹æç¤º
    setTimeout(() => {
      alert("ğŸ® æ¬¢è¿æ¥åˆ°å¤šæ¸¸æˆå¤§å…ï¼\nç‚¹å‡»æŒ‰é’®è¿›å…¥æ¸¸æˆï¼Œæ”¯æŒç¦»çº¿æ¸¸ç©ï¼");
    }, 600);
  </script>
</body>
</html>
